# 颜色分类器

## 环境说明

python版本： python3.6(pytorch_cpu)

IDE：PyCharm 2019.3.4

## 功能

用户判断给出的随机颜色的喜欢与否。程序根据用户的选择进行学习，进而预测用户对于一些新产生的随机颜色的喜欢与否。

## 运行方法

在anaconda虚拟python环境下安装pytorch包之后，导入project并执行main.py，程序按顺序运行。

## 原理

这是一个最简单最基础的分类器算法：设颜色的特征向量为 $[R, G, B]$ ，则预测函数为

$$ h_\theta (x) = \theta_0 + \theta_1 R + \theta_2 G + \theta_3 B $$

损失函数：
$$ J=\frac{1}{m}\sum_{i=1}^m(-y^{(i)} * \log_2(h(x^{(i)})) - (1 - y^{(i)}) * \log_2(1 - h(x^{(i)})))
$$

使用梯度下降法求解最优值，更新方法：

$$\theta_j := \theta_j - \alpha \frac{\sum_{i=1}^m(h(x^{(i)}) - y^{(i)}) x_j^{(i)}}{m}$$

其中$x$, $y$ 是向量，以确保同时更新$\theta$

参数表

|$\alpha$|$[\theta_0, \theta_1, \theta_2, \theta_3 ]$|$\varepsilon$|
|:---:|:---:|:---:|
|$1e-5$|$[-1, -1, -1, -1]$|$1e-3$|

作者为其写了一些输入输出的图形界面，以便于使用。

## 不足与反思

1. 参数值仍有待改进。参数选择还没有经过反复测试，有时会在计算时出现数据溢出的情况，且有些时候梯度下降会较慢。
2. 我曾尝试将其封装为exe程序便于移植，但受困于pytorch包，封装的程序不能运行。
3. 程序结构上，大量依赖外部txt等文档，不利于程序移植性。当然，在移植问题上，pytorch是主要原因。
